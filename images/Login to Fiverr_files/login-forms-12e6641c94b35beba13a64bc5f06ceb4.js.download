!function(){var e={SigningContext:{SIGN_UP:"join",SIGN_IN:"login"},TriggerType:{AUTO:"system_trigger"},AutoShowKeys:{SIGN_UP_SHOWN:"sign_up_auto_shown"},openSignUpModal:function(n,i){var o=_.extend({},n,e.getSignUpModalOptions());e.triggerUserSessionModal({trigger:window.openSignUpModal,options:o,enrichmentParams:i,signingContext:e.SigningContext.SIGN_UP})},openSignInModal:function(n,i){e.triggerUserSessionModal({trigger:window.openSignInModal,options:n,enrichmentParams:i,signingContext:e.SigningContext.SIGN_IN})},triggerUserSessionModal:function(n){var i=_.get(n.options,"forceModal",!1),o=this.isMobileResponsive()&&!i;return o?void e.redirectToStandalonePage(n.signingContext):n.trigger?void n.trigger(n.options,n.enrichmentParams):(e.reportTriggerFail(n.signingContext),void e.redirectToStandalonePage(n.signingContext))},reportTriggerFail:function(n){var i="signing_modal_trigger.fail."+n;e.graph(i)},redirectToStandalonePage:function(e){document.location="/"+e+location.search},getSignUpModalOptions:function(){if(e.isReferralEmailFlow()){var n=ft.utl.getUrlVars();return{forceModal:!0,isSticky:!0,initialValues:{email:decodeURIComponent(n.referral_email)}}}return{}},isReferralEmailFlow:function(){var e=ft.utl.getUrlVars();return!!e.referral_email},reportSignUpClickMixpanelEvent:function(n){e.reportPopupMixpanelEvent(MixpanelWrapper.Events.UserEvents.CLICKED_JOIN,n)},reportSignInClickMixpanelEvent:function(n){e.reportPopupMixpanelEvent(MixpanelWrapper.Events.UserEvents.CLICKED_LOGIN,n)},reportSignInSuccessMixpanelEvent:function(){MixpanelWrapper.trackEvent(MixpanelWrapper.Events.LoginEvents.LOGGED_IN_SUCCESSFULLY,{Provider:"Standard"})},reportPopupMixpanelEvent:function(e,n){MixpanelWrapper.trackEvent(e,{"Source Component":n,"View Type":"Pop-up"})},graph:function(e){Fiverr._broadcastLogEvents({facility:"graphite",type:"long_counter",label:"signing_event."+e,value:1})},submitCheckout:function(e,n){return n?(fGuestCheckout.submitForm(e,n),!0):window.fAnywhereCheckout?(fAnywhereCheckout.submitForm(e),!0):!1},handleAutoShowSignUp:function(){e.shouldAutoShowSignUpModal()&&(e.setAutoShownSignUp(),e.delayModalOpen(function(){e.triggerAutoShowSignUp()}))},triggerAutoShowSignUp:function(){var n={forceModal:!0,triggerType:e.TriggerType.AUTO};e.openSignUpModal(n)},shouldAutoShowSignUpModal:function(){var n=e.isAlreadyAutoShownSignUp(),i=!!ft.utl.getUrlVars().show_join,o=Fiverr.models.ps.push_join_lightbox&&!n;return o&&e.reportAutoShowSignUp(),i||o},reportAutoShowSignUp:function(){e.graph("auto_show_sign_up.triggered"),MixpanelWrapper.trackEvent(MixpanelWrapper.Events.LoginEvents.AUTO_SHOW_SIGN_UP_TRIGGERED,{Provider:"standard"})},isAlreadyAutoShownSignUp:function(){return ft.utl.getLS(e.AutoShowKeys.SIGN_UP_SHOWN,!0,!0)},setAutoShownSignUp:function(){ft.utl.setLS(e.AutoShowKeys.SIGN_UP_SHOWN,!0,!0)},delayModalOpen:function(e){setTimeout(function(){e()},2e3)},isMobileResponsive:function(){return _.get(document.pageScope,"isMobileResponsive",!1)}};window.fLoginFormsUtils=e}(),function(e){var n={models:{c:Fiverr.models.context,b:Fiverr.models.browser,user:Fiverr.models.user,ps:Fiverr.models.ps,eventsDictionary:{click:{join:"signup_click",login:"login_click"}}},init:function(){this.bindModalTriggers(),this.shouldShowEmailReferralSignUp()||fLoginFormsUtils.handleAutoShowSignUp()},bindModalTriggers:function(){this.bindSignUpTrigger(),this.bindSignInTrigger()},bindSignUpTrigger:function(){var i=this;i.models;e(document.body).on("click",".js-open-popup-join",function(o){o.preventDefault();var r=e.cookie("guest_request_data"),t=e(this),a=t.data("eventType"),l=t.data("source-component");if(fLoginFormsUtils.reportSignUpClickMixpanelEvent(l),i.reportEvent("click","join"),n.reportToBigQuery(a),i.setRedirectUrlCookie(t.data("redirect-url")),r){var s=r.split(":")[0];return void n.shouldShowEmailReferralSignUp(s)}fLoginFormsUtils.openSignUpModal()})},bindSignInTrigger:function(){var i=this;e(document.body).on("click",".js-open-popup-login",function(o){o.preventDefault();var r=e(this),t=r.data("eventType"),a=!!r.data("forceModal"),l=r.data("source-component");fLoginFormsUtils.reportSignInClickMixpanelEvent(l),i.reportEvent("click","login"),n.reportToBigQuery(t),i.setRedirectUrlCookie(r.data("redirect-url")),fLoginFormsUtils.openSignInModal({forceModal:a})})},reportToBigQuery:function(n,i){if(n){var o={type:n,group:"signin flow",aux:{uid:e.cookie("u_guid"),http_request:{referrer:e.cookie("session_referer")}}};"undefined"!=typeof i&&(o.event_source=i),Fiverr.sendClientEvents(o)}},getEmailParameter:function(n){var i=e.cookie("team_member_email");return n.referral_email?decodeURIComponent(n.referral_email):i?(ft.utl.removeCookie("team_member_email"),i):""},shouldShowEmailReferralSignUp:function(e){var i=ft.utl.getUrlVars(),o=e||this.getEmailParameter(i);if(o&&!i.show_join){var r=ft.utl.setUrlVars({url:"/",params:{show_join:"true",referral_email:o}});return n.redirectTo(r),!0}return o?(window.fLoginFormsUtils.delayModalOpen(function(){window.fLoginFormsUtils.openSignUpModal()}),!0):!1},setRedirectUrlCookie:function(e){if(e){var n=new Date;n.setTime(n.getTime()+3e5),ft.utl.setCookie("redirect_url",e,n)}else this.unsetRedirectUrlCookie()},unsetRedirectUrlCookie:function(){ft.utl.removeCookie("redirect_url")},reportEvent:function(e,i){var o=this,r=o.models,t=ft.utl.resolve(ft.utl.interpolate("%{0}.%{1}",arguments),r.eventsDictionary);n.reportKey(t,1)},reportKey:function(e,i){e&&i&&(Fiverr._broadcastLogEvents({facility:"aux_data",label:e,value:i},{facility:"graphite",type:"long_counter",label:"signing_event.{platform}.{browser}.form_interaction."+e,value:i}),n.reportToBigQuery(e))},redirectTo:function(e){var n=new RegExp("^"+window.location.origin),i=window.location.href.replace(n,"");i===e?window.location.reload():document.location.href=e}};window.fLoginForms=n,e.once("fiverr-global-parsed",_.bind(n.init,n))}(jQuery);